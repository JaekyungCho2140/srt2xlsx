복수의 .srt (subrip) 파일과 단일 .xlsx (excel) 파일을 양쪽으로 변환하는 도구를 개발하고 싶어.
복수의 .srt 파일은 단일 영상에 사용될 여러 언어의 자막 파일이야. 타임 스탬프 정보가 동일하다는 전제 하에 변환할 거야.
다음의 요구사항을 충족해야 해.
1. .srt -> .xlsx
- .srt 파일은 여러 언어로 구성된 여러 개의 파일이며, 타임 스탬프(시작, 종료 시각)가 동일해.
- 기준이 되는 Source 언어는 한국어야.
- 주로 사용하는 언어는 한국어, 영어, 중국어 번체, 중국어 간체, 일본어, 태국어, 스페인어(남미), 포르투갈어(브라질), 러시아어야. 이는 언어 코드로 다음과 같이 표기 예정이야.
-- 한국어: KO
-- 영어: EN
-- 중국어 번체: CT
-- 중국어 간체: CS
-- 일본어: JA
-- 태국어: TH
-- 스페인어(남미): ES-LATAM 또는 ES
-- 포르투갈어(브라질): PT-BR 또는 PT
-- 러시아어: RU
- .srt 파일의 파일명으로 언어를 감지해. 파일명의 맨 뒤에 _언어코드를 붙여서 파일명을 사용할 거야. 예외는 존재하지 않아. 파일명으로 언어를 감지할 수 없을 때에는 오류를 발생하고, 작업을 중단하고, 앱 사용자에게 올바른 파일 작명법에 대한 가이드를 출력해.
-- 예시: filename_KO.srt, filename_ES.srt, filename_EN.srt
- 변환을 위해 입력 파일로 사용자가 지정한 .srt 파일에 위에서 나열한 언어 중 존재하지 않는 게 있다면, .xlsx에 언어별 열을 생성할 때 헤더만 존재하는 빈 열을 생성해.
- 출력 파일인 .xlsx은 일정한 형식으로 출력돼.
-- 첫 번째 열
--- 헤더 이름: #
--- 용도: 인덱스 번호
-- 두 번째 열
--- 헤더 이름: START
--- 용도: 자막 시작 타이밍
-- 세 번째 열
--- 헤더 이름: END
--- 용도: 자막 종료 타이밍
-- 네 번째 열
--- 헤더 이름: KO/한국어
--- 용도: 한국어 자막
-- 다섯 번째 열
-- 헤더 이름: EN/영어
--- 용도: 영어 자막
[... 러시아어까지 위에서 언급한 순서대로 나머지 부분도 작성해.]
- 서식
-- 전체 글꼴: 맑은 고딕
-- 모든 글자색: 
#000000
-- 헤더 배경색: 
#FFF2CC
-- 데이터가 존재하는 셀 모든 테두리 그리기
-- 시트 이름: Subtitles
- 출력 파일명은 .srt 파일의 공통 영역을 .xlsx의 파일명으로 사용해. 입력 파일명이 언어별로 상이하다는 예외 사항은 취급하지 않으며, 파일명이 언어 코드를 제외하고 상이할 경우엔 오류 메시지를 출력하고, 앱 사용자에게 파일명을 통일시켜달라고 요청해.
-- 예: 입력 파일이 filename_KO.srt, filename_EN.srt, filename_CT.srt, ... 라면, 출력 파일명은 filename.xlsx
2. .xlsx -> .srt
- .xlsx 파일을 입력하면, 시트 내 열의 데이터 존재 여부를 감지하여, 출력할 자막 언어 파일을 결정해.
-- 예: .xlsx 파일 내 한국어 열, 영어 열, 중국어 번체 열만 존재하고 나머지 열은 비어 있다면, 한국어, 영어, 중국어 번체 3개 파일만 출력함.
- 출력파일명은 .xlsx 파일명의 맨 뒤에 _언어코드를 붙여서 작명해.
-- 예: filename.xlsx -> filename_KO.srt, filename_EN.srt, filename_CT.srt, ... 
- 너무 당연한 이야기지만, .srt 파일에 포함되는 타이밍 정보가 엑셀 시트와 정확히 일치해야 해.
3. 기술 스택 선정 시 필요 정보
- 기술 스택 선정 시 이 요구사항을 충족하기 위해, proactively context7 mcp를 활용해.
- Windows 10, 11환경에서만 사용할 도구야.
- Portable 버전, 단일 실행 파일로만 개발할 거야.
- 이 앱은 이번 개발이 완료되면 추가로 유지/보수나 개선할 계획이 전혀 없어.
- .xlsx 파일의 서식 지정이 가능한 라이브러리 사용이 필수야.
- 로그 기능은 필요 없어.
4. 사용자 경험
- 앱을 실행하면 300 x 200 창에 토글 버튼이 하나 있어. 이 토글 버튼은 .srt -> .xlsx, .xlsx -> .srt 2개의 상태만 왔다갔다 해.
- .srt -> .xlsx 활성화 시, 토글 버튼의 오른쪽에 "찾아보기" 버튼이 있어. 이를 누르면 여러 개의 파일을 선택할 수 있는 다이얼로그 창이 떠. 입력할 .srt 파일을 지정하는 창이야.
- .xlsx -> .srt 활성화 시, 토글 버튼의 오른쪽에 "찾아보기" 버튼이 있어. 이를 누르면 단일 파일을 선택할 수 있는 다이얼로그 창이 떠. 입력할 .xlsx 파일을 지정하는 창이야.
- 진행도는 표시할 필요 없고, 완료되었을 때 조그마한 모달로 "완료!"라고만 출력해.
- 토글 버튼과 찾아보기 버튼은 수평을 이뤄야 해.