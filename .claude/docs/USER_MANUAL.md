# Subtitle File Converter 사용자 매뉴얼

> **버전:** 1.6.5
> **최종 업데이트:** 2025년 1월
> **대상 사용자:** 번역 작업자, 콘텐츠 제작자, 로컬라이제이션 팀

---

## 📑 목차

1. [개요](#개요)
2. [설치 및 실행](#설치-및-실행)
3. [기본 사용법](#기본-사용법)
4. [고급 사용법](#고급-사용법)
5. [오류 해결](#오류-해결)
6. [모범 사례](#모범-사례)
7. [FAQ](#faq)
8. [문의 및 지원](#문의-및-지원)

---

# 1. 개요

## 1.1 프로그램 소개

Subtitle File Converter는 **다국어 자막 파일(.srt)과 Excel 파일(.xlsx) 간 양방향 변환**을 지원하는 Windows 전용 데스크톱 도구입니다.

### 주요 기능

- ✅ **SRT → XLSX 변환**: 다중 언어 SRT 파일을 하나의 Excel 파일로 통합
- ✅ **XLSX → SRT 변환**: Excel 파일에서 언어별 SRT 파일 생성
- ✅ **엄격한 검증**: 타임스탬프 동기화, 자막 번호 순서 자동 검증
- ✅ **자동 인코딩 감지**: UTF-8, CP949, 다양한 인코딩 자동 처리

## 1.2 시스템 요구사항

> **최소 요구사항**
>
> - **운영체제:** Windows 10 (64-bit) 이상
> - **RAM:** 4GB 이상 (8GB 권장)
> - **디스플레이:** 1366×768 이상
> - **저장 공간:** 100MB

## 1.3 지원 언어

| 언어 코드 | 언어명 | 파일명 예시 |
|-----------|--------|-------------|
| KO | 한국어 | `subtitle_KO.srt` |
| EN | 영어 | `subtitle_EN.srt` |
| CT | 중국어 번체 | `subtitle_CT.srt` |
| CS | 중국어 간체 | `subtitle_CS.srt` |
| JA | 일본어 | `subtitle_JA.srt` |
| TH | 태국어 | `subtitle_TH.srt` |
| ES-LATAM | 스페인어(남미) | `subtitle_ES-LATAM.srt` |
| PT-BR | 포르투갈어(브라질) | `subtitle_PT-BR.srt` |
| RU | 러시아어 | `subtitle_RU.srt` |

---

# 2. 설치 및 실행

## 2.1 프로그램 설치

> **💡 Tip**
> 이 프로그램은 **포터블 방식**으로 별도의 설치 과정이 필요 없습니다.

1. `srt2xlsx.exe` 파일을 원하는 폴더에 복사
2. 더블클릭으로 바로 실행
3. 관리자 권한 불필요

## 2.2 첫 실행

프로그램을 처음 실행하면 다음과 같은 창이 나타납니다:

- **창 크기:** 300×170 픽셀 (고정)
- **초기 모드:** SRT → XLSX (마지막 사용 모드 기억)
- **창 위치:** 화면 중앙 (마지막 위치 기억)

---

# 3. 기본 사용법

## 3.1 SRT → XLSX 변환 (자막 병합)

여러 언어의 SRT 파일을 하나의 Excel 파일로 통합합니다.

### 단계별 가이드

> **📌 사용 시나리오**
> 한국어, 영어 자막을 Excel로 통합하여 다른 언어 번역 작업을 진행

**Step 1.** 토글 스위치가 **"SRT → XLSX"** 모드인지 확인

**Step 2.** **"파일 선택"** 버튼 클릭

**Step 3.** 변환할 SRT 파일 선택
- `Ctrl + 클릭`으로 다중 선택
- 모든 파일이 **같은 폴더**에 있어야 함

**Step 4.** **"변환"** 버튼 클릭

**Step 5.** 변환 완료 메시지 확인
- 같은 폴더에 Excel 파일 생성됨

### 파일명 규칙

**올바른 파일명 예시:**
```
video_KO.srt
video_EN.srt
episode01_JA.srt
subtitle_ES-LATAM.srt
```

> **⚠️ 주의사항**
>
> - 파일명은 반드시 `파일명_언어코드.srt` 형식
> - 마지막 언더스코어(`_`) 뒤에 언어 코드
> - `ES-LATAM`, `PT-BR`은 하이픈(-) 사용

### 생성되는 Excel 파일 형식

| 열 | 내용 | 설명 |
|----|------|------|
| A | # | 자막 번호 |
| B | START | 시작 시간 (HH:MM:SS,mmm) |
| C | END | 종료 시간 (HH:MM:SS,mmm) |
| D | KO/한국어 | 한국어 자막 텍스트 |
| E | EN/영어 | 영어 자막 텍스트 |
| F | CT/중국어 번체 | 중국어 번체 자막 텍스트 |
| G | CS/중국어 간체 | 중국어 간체 자막 텍스트 |
| H | JA/일본어 | 일본어 자막 텍스트 |
| I | TH/태국어 | 태국어 자막 텍스트 |
| J | ES-LATAM/스페인어(남미) | 스페인어 자막 텍스트 |
| K | PT-BR/포르투갈어(브라질) | 포르투갈어 자막 텍스트 |
| L | RU/러시아어 | 러시아어 자막 텍스트 |

### Excel 파일 서식

**헤더 행:**
- 배경색: 연한 노란색 (#FFF2CC)
- 폰트: 굵게, 12pt
- 정렬: 가운데 정렬

**데이터 행:**
- 폰트: 10pt
- A열 너비: 4
- B, C열 너비: 12 (가운데 정렬)
- D~L열 너비: 24 (자동 줄바꿈 해제)
- 수직 정렬: 모든 열 중앙

---

## 3.2 XLSX → SRT 변환 (자막 분할)

Excel 파일에서 언어별 SRT 파일을 생성합니다.

### 단계별 가이드

> **📌 사용 시나리오**
> Excel에서 번역 작업을 완료한 후 각 언어별 SRT 파일 생성

**Step 1.** 토글 스위치를 **"XLSX → SRT"** 모드로 변경

**Step 2.** **"파일 선택"** 버튼 클릭

**Step 3.** 변환할 Excel 파일 선택

**Step 4.** **"변환"** 버튼 클릭

**Step 5.** 변환 완료 메시지 확인
- 같은 폴더에 언어별 SRT 파일 생성
- **빈 언어 열은 자동으로 제외**

### 빈 열 처리

> **💡 자동 제외 조건**
> Excel에서 특정 언어 열의 모든 셀이 비어있거나 공백만 있으면 해당 언어의 SRT 파일은 생성되지 않습니다.

**예시:**
- KO, EN 열만 내용이 있고 나머지가 비어있음
- → `파일명_KO.srt`, `파일명_EN.srt`만 생성됨

---

# 4. 고급 사용법

## 4.1 다중 언어 번역 워크플로우

**권장 작업 흐름:**

```
1단계: 원본 SRT 파일 준비 (예: KO, EN)
   ↓
2단계: SRT → XLSX 변환으로 Excel 생성
   ↓
3단계: Excel에서 다른 언어 열 번역 작업 (JA, CT 등)
   ↓
4단계: XLSX → SRT 변환으로 새 언어 SRT 파일 생성
   ↓
5단계: 생성된 모든 언어 SRT 파일 확인
```

**실제 예시:**

```
초기 상태: video_KO.srt + video_EN.srt
    ↓ SRT → XLSX
video.xlsx (KO, EN 열만 채워짐)
    ↓ Excel에서 JA, CT 열 번역 추가
    ↓ XLSX → SRT
최종: video_KO.srt, video_EN.srt, video_JA.srt, video_CT.srt
```

## 4.2 대용량 파일 처리

> **⚠️ 10,000행 이상의 자막**
> 파일이 10,000행을 초과하면 경고 메시지가 표시됩니다. 처리 시간이 오래 걸릴 수 있으니 참고하세요.

### 메모리 부족 경고

시스템 메모리가 부족할 경우:

1. 경고 메시지 표시
2. 계속 진행 또는 중단 선택 가능
3. 다른 프로그램 종료 후 재시도 권장

---

# 5. 오류 해결

## 5.1 일반적인 오류

### ❌ "자막 번호가 순차적이지 않습니다"

**문제 원인:**

```
1
00:00:01,000 --> 00:00:03,500
Hello

3  ← 2번이 누락됨
00:00:05,200 --> 00:00:08,750
World
```

**해결 방법:** SRT 파일의 자막 번호가 1부터 순차적으로 증가하도록 수정

---

### ❌ "파일 간 타임스탬프가 일치하지 않습니다"

**원인:** 동일 번호의 자막이 언어별로 다른 타임스탬프를 가짐

**해결 방법:**
- 모든 언어의 동일 번호 자막은 **정확히 같은 타임스탬프** 필요
- 1ms라도 다르면 오류 발생

**올바른 예시:**

```
subtitle_KO.srt:
1
00:00:01,000 --> 00:00:03,500
안녕하세요

subtitle_EN.srt:
1
00:00:01,000 --> 00:00:03,500  ← KO와 완전히 동일
Hello
```

---

### ❌ "지원되지 않는 언어 코드"

**잘못된 파일명:**
- ❌ `subtitle-KO.srt` (하이픈 대신 언더스코어 필요)
- ❌ `subtitle_KO_final.srt` (언어 코드 뒤에 추가 문자)
- ❌ `subtitle_ES_LATAM.srt` (`ES-LATAM`에 하이픈 필요)

**올바른 파일명:**
- ✅ `subtitle_KO.srt`
- ✅ `subtitle_ES-LATAM.srt`
- ✅ `subtitle_PT-BR.srt`

---

### ❌ "Excel 헤더가 올바르지 않습니다"

**원인:** Excel 파일의 첫 번째 행이 정확히 일치하지 않음

**해결 방법:** 첫 번째 행이 다음과 같아야 함 (대소문자 구분)

```
#  START  END  KO/한국어  EN/영어  CT/중국어 번체  CS/중국어 간체  JA/일본어  TH/태국어  ES-LATAM/스페인어(남미)  PT-BR/포르투갈어(브라질)  RU/러시아어
```

---

### ❌ "파일이 이미 열려 있습니다"

**원인:** Excel 파일이 다른 프로그램에서 열려 있음

**해결 방법:**
1. Excel 또는 다른 프로그램에서 파일 닫기
2. 프로그램 재시도

---

### ❌ "프로그램이 이미 실행 중입니다"

**원인:** 프로그램이 이미 실행 중이거나 비정상 종료된 lock 파일이 남아있음

**해결 방법:**
1. 작업 관리자에서 프로그램 종료
2. `srt2xlsx.lock` 파일 삭제 (프로그램과 같은 폴더)
3. 프로그램 재시작

---

## 5.2 오류 코드 참조

### 검증 오류 (100번대)

| 코드 | 메시지 | 해결 방법 |
|------|--------|-----------|
| 101 | 자막 번호가 순차적이지 않습니다 | 자막 번호 1부터 순차 확인 |
| 102 | 타임스탬프 형식이 올바르지 않습니다 | HH:MM:SS,mmm 형식 확인 |
| 103 | 파일 간 타임스탬프가 일치하지 않습니다 | 동일 번호 자막의 타임스탬프 일치 확인 |
| 104 | 자막 번호가 중복되었습니다 | 중복된 자막 번호 제거 |
| 105 | 자막 번호는 1부터 시작해야 합니다 | 첫 번째 자막 번호를 1로 변경 |
| 106 | Excel 헤더가 올바르지 않습니다 | 헤더 행 형식 확인 |
| 107 | 종료 시간이 시작 시간보다 빠릅니다 | 타임스탬프 순서 확인 |
| 108 | 파일 간 자막 개수가 다릅니다 | 모든 파일의 자막 개수 동일하게 조정 |

### 파일 I/O 오류 (200번대)

| 코드 | 메시지 | 해결 방법 |
|------|--------|-----------|
| 202 | 파일 인코딩을 감지할 수 없습니다 | UTF-8 또는 CP949로 재저장 |
| 203 | 파일이 이미 열려 있습니다 | 파일을 닫고 재시도 |
| 204 | 지원되지 않는 언어 코드 | 지원 언어 코드 확인 |
| 205 | 파일명에 사용할 수 없는 문자 포함 | Windows 금지 문자 제거 |
| 206 | 출력 파일을 생성할 수 없습니다 | 기존 파일 삭제 또는 이름 변경 |

### 시스템 오류 (300번대)

| 코드 | 메시지 | 해결 방법 |
|------|--------|-----------|
| 301 | 프로그램이 이미 실행 중입니다 | 중복 실행 확인, lock 파일 삭제 |
| 302 | 메모리가 부족합니다 | 다른 프로그램 종료 후 재시도 |
| 303 | 디스크 공간이 부족합니다 | 디스크 공간 확보 |

---

# 6. 모범 사례

## 6.1 파일 관리

**권장 폴더 구조:**

```
project/
├── source/              ← 원본 파일
│   ├── video_KO.srt
│   └── video_EN.srt
├── working/             ← 작업 폴더
│   ├── video_KO.srt
│   ├── video_EN.srt
│   └── video.xlsx
└── output/              ← 최종 결과물
    ├── video_KO.srt
    ├── video_EN.srt
    ├── video_JA.srt
    └── video_CT.srt
```

## 6.2 파일명 규칙

> **💡 Tip**
> 일관된 파일명 사용
> 프로젝트 내에서 동일한 파일명 패턴을 유지하면 작업이 훨씬 수월합니다.

**좋은 예시:**
```
episode01_KO.srt
episode01_EN.srt
episode02_KO.srt
episode02_EN.srt
```

**나쁜 예시:**
```
ep1_korean.srt
episode_01_english.srt
E02_KO.srt
```

## 6.3 작업 팁

1. **백업 습관**: 변환 전 원본 파일 항상 백업
2. **단계별 검증**: 각 단계마다 결과물 확인
3. **파일 개수 제한**: 한 번에 너무 많은 파일 처리 지양
4. **Excel 주의**: 변환 중에는 Excel 파일을 열지 말 것

---

# 7. FAQ

### Q1. 한 번에 몇 개의 파일을 변환할 수 있나요?

**A.** 이론적으로는 제한이 없으나, **10,000행 이하**를 권장합니다. 대용량 파일은 처리 시간이 길어질 수 있습니다.

---

### Q2. 네트워크 드라이브의 파일도 사용할 수 있나요?

**A.** 네, 가능합니다. 단, 네트워크 지연이 발생할 수 있으니 로컬 드라이브 사용을 권장합니다.

---

### Q3. 프로그램 설정은 어디에 저장되나요?

**A.** `settings.ini` 파일이 프로그램 실행 파일과 같은 폴더에 자동 생성됩니다. 마지막 사용 모드, 창 위치, 마지막 폴더 정보가 저장됩니다.

---

### Q4. Excel 파일을 수정한 후 다시 변환할 수 있나요?

**A.** 네, 가능합니다. 헤더 행을 수정하지 않고 데이터만 수정하면 정상적으로 변환됩니다.

---

### Q5. 특정 언어만 선택적으로 변환할 수 있나요?

**A.** XLSX → SRT 변환 시 빈 언어 열은 자동으로 제외됩니다. 원하지 않는 언어 열을 비워두면 해당 언어의 SRT 파일은 생성되지 않습니다.

---

### Q6. 프로그램이 응답하지 않으면 어떻게 하나요?

**A.** 대용량 파일 처리 중일 수 있습니다. 잠시 기다려주세요. 장시간 응답이 없으면 작업 관리자에서 강제 종료 후 재시도하세요.

---

# 8. 문의 및 지원

> **📞 기술 지원**
>
> - **버그 리포트:** 개발팀에 문의
> - **기능 제안:** 개발팀에 문의
> - **긴급 문의:** 기술지원팀 연락

## 8.1 문의 시 포함할 정보

버그 리포트나 문의 시 다음 정보를 함께 제공해주세요:

1. **프로그램 버전**: 1.6.5
2. **Windows 버전**: (예: Windows 10, Windows 11)
3. **오류 메시지**: 전체 텍스트 복사
4. **재현 단계**: 오류 발생까지의 단계별 설명
5. **파일 정보**: 파일 크기, 자막 개수

---

# 부록

## A. SRT 파일 형식 예시

**sample_KO.srt:**

```
1
00:00:01,000 --> 00:00:03,500
안녕하세요, 여러분!

2
00:00:05,200 --> 00:00:08,750
오늘은 좋은 날씨네요.

3
00:00:10,000 --> 00:00:12,000
감사합니다.
```

**sample_EN.srt:**

```
1
00:00:01,000 --> 00:00:03,500
Hello, everyone!

2
00:00:05,200 --> 00:00:08,750
It's a beautiful day today.

3
00:00:10,000 --> 00:00:12,000
Thank you.
```

이 두 파일을 SRT → XLSX로 변환하면 하나의 Excel 파일이 생성됩니다.

## B. 키보드 단축키

현재 버전에서는 키보드 단축키를 지원하지 않습니다.

## C. 버전 이력

| 버전 | 날짜 | 변경 사항 |
|------|------|-----------|
| 1.6.5 | 2025-01 | Excel 서식 개선, UI 폰트 변경 |
| 1.6.0 | 2024-12 | 초기 릴리스 |

---

**문서 버전:** 1.0
**최종 수정일:** 2025년 1월
**작성자:** 개발팀
